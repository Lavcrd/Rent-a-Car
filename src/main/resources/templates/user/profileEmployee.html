<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Rent-a-Car</title>

    <link rel="stylesheet" type="text/css" href="/css/styles.css"/>
    <link rel="stylesheet" href="/webjars/bootstrap/5.2.3/css/bootstrap.min.css"/>
</head>

<body>
<div id="container" class="container-md">
    <div th:include="fragments/top::top-menu"></div>
    <div th:include="fragments/top::reg-options"></div>

    <div id="main">
        <table class="table table-borderless">
            <thead class="table-dark">
            <tr>
                <th scope="row">Account</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">Name</th>
                <td th:text="${user.getName()} + ' ' + ${user.getSurname()}"></td>
                <td style="width: min-content; padding: 0;">
                    <button data-bs-toggle="modal"
                            data-bs-target="#password_modal" type="button" class="btn btn-dark w-100" th:text="'Change password'"></button>
                </td>
            </tr>
            <tr>
                <th scope="row">E-mail</th>
                <td th:text="${username}"></td>
            </tr>
            <tr>
                <th scope="row">Account type</th>
                <td th:text="${user.getRole().name().substring(5)}"></td>
            </tr>
            <th:block sec:authorize="hasAnyRole('ROLE_EMPLOYEE', 'ROLE_MANAGER')">
                <tr>
                    <th scope="row">Department</th>
                    <td th:text="${user.getDepartment().getCountry().getCode()} + ' — ' + ${user.getDepartment().getCity()} + ', ' + ${user.getDepartment().getAddress()}"></td>
                </tr>
            </th:block>
            <th:block sec:authorize="!hasAnyRole('ROLE_ADMIN')">
                <tr>
                    <th scope="row">Expiry date</th>
                    <td th:text="${user.getTerminationDate()}"></td>
                </tr>
            </th:block>
            </tbody>
        </table>

        <!--Modal password-->
        <form th:method="POST" th:object="${password_form}" th:action="@{'/profile/password'}">
            <div class="modal fade" id="password_modal" tabindex="-1" role="dialog"
                 aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Change password</h5>
                            <button type="button" class="close" data-bs-dismiss="modal"
                                    aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <p>Please confirm your <u>password change</u>.</p>

                            <div class="modal-row mt-2">
                                <label style="justify-self: start;" for="old_password"
                                       class="text-md">Old password: </label>
                                <input id="old_password" class="text-black bg-white modal-input" th:placeholder="'Current password'"
                                       th:type="password" th:field="*{currentPassword}" autocomplete="new-password"
                                       required/>
                            </div>

                            <div class="modal-row mt-2">
                                <label style="justify-self: start;" for="new_password"
                                       class="text-md">New password: </label>
                                <input id="new_password" class="text-black bg-white modal-input" th:placeholder="'New password'"
                                       th:type="password" th:field="*{newPassword}" autocomplete="new-password"
                                       required/>
                            </div>

                            <div class="modal-row mt-2">
                                <label style="justify-self: start;" for="repeat_new_password"
                                       class="text-md">Repeat new password: </label>
                                <input id="repeat_new_password" class="text-black bg-white modal-input" th:placeholder="'Repeat new password'"
                                       th:type="password" autocomplete="new-password"
                                       th:field="*{newPasswordRepeat}" required/>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-dark" data-bs-dismiss="modal">
                                Close
                            </button>
                            <button type="submit" class="btn btn-dark">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                     class="bi bi-save" viewBox="0 0 16 16">
                                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                                </svg>
                                Confirm</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <div th:include="fragments/bottom::bottom-footer"></div>
        <div th:insert="fragments/bottom::message-handler"></div>
    </div>
</div>
<div th:include="fragments/bottom::common-scripts"></div>
</body>
</html>